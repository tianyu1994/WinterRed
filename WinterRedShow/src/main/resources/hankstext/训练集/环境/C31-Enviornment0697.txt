环境科学学报
ACTA　SCIENTIAE　CIRCUMSTANTIAE
1998年1月第18卷第1期科技期刊
活性污泥法的多变量最优控制*
Ⅱ.限制有机物(BOD)的排放总量
彭永臻　王宝贞　王淑莹
(哈尔滨建筑大学市政环境工程学院，150008)

摘要　着重研究了在限制有机物排放总量时，使其运行费用最低的最优周期控制问题.通过增加新的状态变量和用补偿函数法，将本课题的有约束条件问题化为无约束条件问题，并提出了最优步长参数的动态搜索法来修改传统的梯度法，从而较完善地解决了多变量最优周期控制的计算问题.研究中还发现了不同初始条件下最优控制所需要的运行费用也大不相同，进而提出了最优初始状态下最优周期控制的新概念，这对保证出水质量的同时进一步降低污水处理成本来说具有更重要的意义.本文还强调指出：对于尚不具备实现最优控制条件的处理系统，可根据最优控制的研究结果实现具有广泛实用价值的准最优控制.
关键词　活性污泥法；最优周期控制；BOD排放总量.
MULTIVARIABLE OPTIMAL CONTROL OF ACTIVATED SLUDGE PROCESS:Ⅱ.LIMITATION OF TOTAL SUBSTRATE(BOD) DISCHARGE MASS

Peng Yongzhen, Wang Baozhen, Wang Shuying
(Department Environment and Municipal Engineering,Harbin University of Architecture and Engineering,150008)

ABSTRACT　Optimal periodic control with the lowest operational cost by limiting total substrate discharge mass was studied.Through adding new state variable and using supplement functions,the problem with restriction conditions was converted into nonrestriction problem.In addition,the dynamic searching method of optimal step coefficient was developed to modify the conventional gradient method,consequently the calculation problem of the multivariable optimal periodic control was able to be resolved better.It was found that the operational costs of optimal control under various initial states are distinctly different.A new concept of optimal control under optimal initial state was presented.It is pointed out emphatically that to the treatment system without optimal control condition,the suboptimal control with extensive practical value can be realized according to the results of optima control.
Keywords　activated sludge process, optimal periodic control, BOD total discharge mass.
　　
1　前言
　　前文［1］已经证实污泥排放量Qw和溶解氧浓度DO是活性污泥法运行中的两个最重要的控制变量，它们既能控制出水水质又能改变运行费用.而且，在满足某一出水质量的前提下，在不同的定常Qw和DO控制下，其运行费用也不同，大约在DO为0.9mg/L时运行费用最低.但是，这并不是最优控制，本文研究的最优控制问题是在限制有机物(底物)排放总量的约束下，寻求使运行费用最省的最优控制变量Qw和DO的变化规律.最优控制变量主要取决于三个因素：一是进水水质水量的变化情况；二是满足规定的出水水质；三是性能指标表达式及所要达到的目标.
　　由于各国与各地区的经济发展水平、水污染状况以及受纳水体的功能不同等多方面原因，各地的污水排放标准与污水处理厂出水水质要求都有所不同［2，3］.例如，限制污水处理厂出水中有机物排放的总量、或要求出水有机物浓度不超过某一标准、或同时限制出水中平均和最高有机物浓度分别不超过规定的指标等.限制出水中有机物排放总量属于污染总量控制，是一种常用的排放标准，尤其对于工业废水的排放.本文在研究限制有机物排放总量的最优控制模型与计算方法的基础上，通过对该问题的求解，来讨论与本课题有关的理论问题.

2　最优控制数学模型与计算方法
2.1　建立最优控制数学模型
　　应当指出，本课题是比较复杂的有约束条件最优控制问题.其约束条件有三：一是要求满足有机物排放总量的限制；二是要求状态变量每日的末值与初值相同，三是控制变量Qw和DO只能在一定范围内取值，例如DO必须大于零而小于其饱和值，Qw也不能为负值等.满足了第二个约束条件后，在进水水质水量呈周期变化的情况下，状态变量每日也呈周期变化，进而可实现最优周期控制(以下也简称量优控制).显然研究污水处理系统最优周期控制更有实际意义，否则每日进水水质水量呈周期变化而每日的最优控制变量却无规律变化，这样的最优控制既无实际意义也难于实现.本文通过增加状态变量并用补偿函数法在求解过程中使前两条约束条件得到满足，第三条可以用庞特里亚金(Pontryagin)的极大值原理来解决.
　　为了满足有机物排放总量的限制条件，在状态方程中增加一个状态变量Z(t),Z表示每日内出水中排出的有机物总量随时间t的变化，则有
Z(t)=∫t0QSdt(1)
新状态变量Z对时间的导数为
(2)
由于Z的初值Z(0)=0，则其末值Z(1)就表示每日排放的有机物总量
Z(1)＝∫10QSdt(3)
这样，上述前两条约束条件都是状态变量的末值约束条件，可表示为

(4)
式中X0,S0――分别为状态变量X，S的初值，已知数；
Zs――每日允许排放的有机物总量，首先取Zs=150kg(BOD)/d，相当于平均出水BOD为15mg/L.
　　由于最优控制问题的数值计算方法――梯度法只能求解无约束条件问题，因此，采用补偿函数法［4］，在计算过程中取消式(4)的末值约束条件，作为补偿在性能指标式(文献［1］中式(18))中引入一个反映末值约束条件受破坏程度的函数，使之变为无约束条件问题，得到一个新的性能指标J：

(5)
式中G1、G2和G3为足够大的正数，等式右端的前三项为补偿函数.显然G1、G2和G3的值不断增大，约束条件式(4)受破坏的程度越小，通过计算求出使新的性能指标J为最小值的最优控制，即能使运行费用JC最省同时又满足了式(4)给出的末值约束条件.
　　由新状态变量Z的导数式(2)与基本状态方程(文献［1］中式(6))联立，组成一个新状态方程：

(6)
根据最优控制的计算方法［4］，还需引入拉格朗日(Lagrange)乘子λ1、λ2和λ3，它们是时间的未知函数，也称伴随变量.再由新性能指标式(5)中的被积函数与状态方程式(6)中3个微分方程的右端项分别乘以λ1、λ2和λ3之和，构成求解所必需的哈密顿(Hamilton)函数H.

(7)
再通过H函数对3个状态变量的偏导数-H/X,-H/S和-H/Z，得出求解最优控制所必需的伴随方程式(8)：

(8)
　　最优控制理论指出，使H函数取得最小值的最优控制Qw和DO也能使新性能指标J取得最小值.如果控制变量Qw和DO的取值范围不受约束，最优控制应当是由式(6)、式(8)和H/Qw=0、H/DO=0这个两代数方程(见后)组成的联立方程的解.其中状态方程式(6)的初值条件即状态变量初值为已知
X(0)=X0, S(0)=S0, Z(0)=0(9)
伴随方程式(8)的末值条件可由新性能指标(5)右端前三项的补偿函数分别对状态变量末值X(1)、S(1)和Z(1)的偏导数给出，也称横截条件，如下

(10)
可见该联立方程由8个方程组成，含2个代数方程以及6个微分方程，和6个端点条件，可解出8个解X、S、Z、λ1、λ2、λ3、Qw、DO，其中Qw和DO即为所求的最优控制.这样就把求解最优控制问题变成了求解微分方程的两点边值问题.然而，本研究的控制变量Qw和DO的取值受约束，在其约束条件下可能有H/Qw≠0与H/DO≠0，对此只能用庞特里亚金的极大值原理来求解［4］.极大值原理指出，虽然最优控制此时不能满足H/Qw=0,H/DO=0，但仍能使H函数取得极值.因此，本研究的最优控制求解就变为，在控制变量的约束条件下，寻求满足方程式(6)和式(8)及其端点条件式(9)和式(10)，并且使H函数为最小的控制变量Qw(t)和DO(t)了.
2.2　最优步长参数的动态搜索法
　　用梯度法求解最优控制的基本思想是，首先猜测一组Q0w和DO0，在初始条件式(9)和末值条件式(10)下，求解状态方程式(6)和伴随方程式(8).因为猜测的Q0w和DO0不是最优控制，必须对其进行逐次修正，而且每次修正均沿H值的“最陡下降”方向即梯度方向H/Qw和H/DO进行

(11)
式中K1、K2是大于零的步长参数.由式(7)得到H值的梯度为

(12)
　　通过逐次修正，Qiw和DOi，求解上述微分方程，使对应的H函数值与性能指标J和运行费用JC以较快速度减小，直到趋近于最小值，得到满足所有约束条件使运行费用最省的最优控制变量Qw(t)和DO(t)的变化规律，与其相对应的状态变量X(t)和S(t)称为最优轨线.


图1　随着迭代计算次数的增加
DO(t)向最优控制逼近的态势
Fig.1 The trend of DO approaching to optimal 
control with increase of the teriteration times
上述数值计算的工作量是非常大的，尤其当步长参数K1和K2选取的值较小时，计算机也难以忍受；而当K1和K2取较大数值时，迭代过程发散，无法求解.一般靠经验选取K1和K2值［4～6］.为此，我们在研究中提出了一种最优步长参数的动态搜索法，来改善传统的梯度法，它能在每次修正Qi+1w、,DOi+1时都经过若干次试算，然后确定一组尽可能大但又不使迭代过程发散的步长参数Ki1和Ki2.结果表明这种计算方法大大提高了计算效率，减少了计算次数，使本课题的数值计算可以用微机来实现.图1表示在按最优步长参数的动态搜索法计算过程中，首先猜测控制变量之一DO(t)为定常值0.9mg/L的情况下，DO(t)随着迭代计算次数(共经过660次计算，每次计算中搜索最优步长参数还需进行若干次迭代计算)的增加向最优控制逼近的态势.图中只给出其中十几次的计算结果，每条曲线与上面的数字表示经过该次计算后DO的计算结果.这一计算方法成功地解决了靠经验或盲日地选取固定的K1和K2值带来的计算工作量极大或发散的问题.

3　结果与分析
　　在进行计算时，除专门说明以外，其动力学常数与有关参数的取值仍采用文献［1］中表1给出的数值，进水流量及其底物浓度的变化仍按文献［1］中式(19)、文献［1］中图2所示；仍限制系统每日排出的底物不超过150kg(BOD)/d.
表1　X(0)=2000mg/L时最优控制的部分计算结果
Table 1 Calculating results of optimal controls at X(0)=2000mg/L

X(t)，mg/LS(t)，mg/LQw(t),m3/dDO(t),mg/Lt,dZ(t),kg/d
2000.09.9602.856900
2011.713.2103.27750.0506.246
2027.316.7703.60610.10015.447
2046.620.2403.83080.150
2069.023.0303.94770.20043.682
2093.524.5203.96720.25061.513
2118.824.304.8193.89770.30079.831
2143.222.3510.4603.74140.35096.769
2165.219.1214.9603.49960.400110.859
2183.715.3218.2703.18070.450121.447
2194.811.65206.9402.81330.500128.718
2193.48.60356.4302.43620.550133.378
2183.06.31448.1602.09240.600136.253
2166.64.75505.3501.81850.650138.034
2146.33.82544.1501.64290.700139.215
2123.73.42575.2001.58410.750140.124
2099.83.53606.3201.64940.800140.998
2075.34.16645.4801.83560.850142.057
2050.75.39703.4302.12810.900143.593
2025.67.30792.8402.48770.950146.034
2000.09.96879.5402.85691.000150.000
J(N)(元/d)JC(N)(元/d)NSa(N)(mg/L)JD(N)(元/d)
螃
2177.78402177.693058615.000.0002
2177.78402177.692058715.000.0002
2177.78402177.692058815.000.0000

3.1　最优初始状态下最优控制的新概念
　　为了实现每日的最优周期控制，除了必须使每日的初始状态与末端状态相同以外，还必须使控制变量之一DO的初值DO(0)与末值DO(1)相等，否则无法实现次日的最优周期控制.表1表示设定状态变量初值X(0)为2000mg/L时，最优周期控制的部分计算结果.N表示计算次数，Sa表示平均出水底物浓度，JD表示前后两次计算出的J的差值.
　　可见，DO必须控制在1.58―3.97mg/L之间，才能满足每日排出的底物不大于150kg(BOD)/d.在每日的前10h(t＝0.4d)，基本不排放污泥，以便在进水流量及其BOD浓度处于高峰(见文献［1］中图2)，而曝气池内原有的MLSS浓度又不高且DO浓度又较高情况下，尽可能提高MLSS浓度.其目的是尽可能降低此时的DO浓度，以减少供氧所需要的费用.之后，在进水BOD负荷较低且DO较低时大量排放污泥，并使Z(1)恰好为150kg/d且状态变量初值与末值相同.


图2　X(0)＝2400mg/L时最优控制与最优轨线的
变化情况(JC=1826元/d)
Fig.2 Optimal controls and optimal trajectories atX(0)=2400mg/L(JC=1826yuan/d)


图3　X(0)＝2800mg/L时最优控制与最优轨线的
变化情况(JC=1893元/d)
Fig.3 Optimal controls and optimal trajectories at
X(0)=2800mg/L(JC=1893yuan/d)
　　图2和图3给出了状态变量初值X(0)分别为2400和2800mg/L时最优周期控制的计算结果.它们都满足了所有的约束条件.当X(0)为2800mg/L时，由于其MLSS浓度较高，最高的DO浓度也不超过0.96mg/L.在每日前6h(t＝0、25d)内大量地排放污泥，因为此时其污泥回流所需的费用已不可忽视，同时由于DO很低，适当增大DO不会增大很多的供氧费用，因此适当减小MLSS增大DO才能尽可能降低运行费用.每日后期减小排放污泥量是为了满足X(1)也等于2800mg/L.总之，从上述所有计算结果来看，不同初始状态下的最优控制与最优轨线，都是在满足所有约束条件前提下使其运行费用最少.
　　在研究中，我们发现，不同初始状态下最优控制时的运行费用也大不相同.为进一步研究这一问题，又进行了初始状态X(0)为2000至3000mg/L条件下最优周期控制时所对应的运行费用.如表2所示.当X(0)为2400mg/L左右时其最优控制下的运行费用最低，为1826元/d.
表2　不同初始状态X(0)条件下最优控制时的运行费用
Table 2 Operation costs of optimal controls under various initial states X(0)

X(0),mg/L20002100220023002400250026002700280029003000
JC,元/d21781914184618331826183218471868189319041936

　　我们认为，上述研究结果说明，当处理系统的动力学常数与其它参数或进水水质水量变化，特制是出水质量要求等方面与本文给定的情况有所不同时，其运行费用最低的最优控制对应的初始状态变量X(0)不一定在2400mg/L左右.但是，对于特定条件下的处理系统，运行费用最低时所对应的X(0)及其最优控制变化规律总是存在并可以找到的.这就是在活性污泥法最优控制研究中，我们首次提出的“最优初始状态下最优控制”的新概念.虽然在有关最优控制理论的专著中［4～6］都未谈及这个问题，但在本研究中是明显存在的，也是可以解释的.这一新概念的合理解释是，由于约束了X(0)=X(1)，则初始状态变量X(0)的大小基本决定了曝气池中的MLSS浓度的变化范围，MLSS越低DO必须越高，反之亦然.由前文［1］的研究可知，维持过高或过低的DO(或MLSS)浓度都不利于节省运行费用，因此存在一个使运行费用最省的初值X(0)，即MLSS和DO浓度的变化范围.无疑，最优初始状态下最优周期控制的研究，对于在保证处理水质的同时降低其处理成本具有更重要的意义.
3.2　污泥处理费用与最优控制的关系
　　本研究表明，改变处理系统中的常数或参数，得出的最优控制变化规律也将或多或少地随之改变.但有些参数的改变对其影响不大，有的影响较大，有些参数本身变化范围不大.例如，改变单位污泥量所需要的处理费用A这一参数的值对最优控制影响较大，并且由于污泥处理处理的方法与程度不同，这一参数在不同系统中变化范围是很大的.
　　将参数A值由1.1增大至3.1和4.1元/kg(MLSS)(其它参数值不变)、初值X(0)均为2400mg/L的最优控制计算结果中.得到这两者的运行费用分别为3049和3654元/d，除了后者的理所当然地高一些之外，它们的最优控制变量的变化规律基本一致，都与A值为1.1元/kg(MLSS)时的大不相同.其中DO的变化规律与A=1.1元/kg时DO的变化规律几乎相反，即最优控制DO与状态变量S的变化呈负相关关系.这是因为随着A值的增大，污泥处理费用J2占整个运行费用JC的比重也增大，而在过程控制中减小JC和J2的重要途径就是减小污泥排放量，并通过在进水有机物负荷与底物浓度S较低时适当提高DO浓度，增大微生物的衰减(内源呼吸)速率来实现.这就是说，在低底物浓度下提高DO能更有效地减少污泥增长量.
3.3　准最优控制策略的意义
　　上述研究结果表明，污水处理系统的最优控制与其它控制策略相比具有三方面的优越性：一是它不仅能使运行稳定可靠、出水水质达到预定标准，而且可使出水水质刚好满足要求不增加处理成本；二是能在出水水质达标的前提下尽可能减少运行费用；三是满足了若干约束条件可实现最优周期控制，其最优初始状态下最优控制更具有重要意义.最优控制有如此大的优越性，今后如何实现它将是一个长远的重大研究课题.
　　通过上述研究可以看到，尽管系统中的各种参数的取值、初始状态与约束条件等都对最优控制变量的变化规律产生不同的影响，但是，对某一特定的处理系统与各种特定条件，总可以求出其最优初始状态下的最优控制变化规律.由此我们可以得到如下启示：虽然实现最优控制至少需要对系统进行连续监测与在线控制，但是，对于尚不具备实现最优控制条件的污水处理厂，完全可以根据求出的该特定处理系统最优初始状态下的最优控制变量Qw和DO的变化规律，通过手动或半自动控制来模拟最优控制，还可与得出的最优轨线X和S的变化规律对比来调整控制变量Qw和DO.这种控制策略在现代控制论中称为准最优控制.准最优控制也很适用于每日进水水质水量变化并不严格遵循某一规律的污水处理厂，随着进水水质水量和状态变量的变化态势来调整控制变量.从目前来看，准最优控制将有更广泛的实用价值.

4　结论
　　1.首先充分地阐述了最优周期控制的必要性.通过增加新的状态变量Z(t)、修改状态方程和性能指标，采用补偿函数法将有机物排放总量限制和状态变量末端限制条件的最优控制问题化为无约束条件问题，然后，根据庞特里亚金极大值原理建立适合于求解本最优周期控制问题的数学模型.
　　2.本研究提出了最优步长参数的动态搜索法来修改传统的梯度法，并研制了相应的计算机程序，从而解决了只靠经验来选择步长参数导致迭代计算振荡发散问题，大大提高了计算速度，使本问题用微机计算成为可能.
　　3.研究结果发现，不仅某一个初始条件下存在使运行费用最少的最优控制，而且，还存在一个使运行费用更少的初始条件，由此，我们提出了最优初始状态下最优周期控制的新概念.这对于保证出水质量的同时降低污水处理成本具有更重要的意义.
　　4.改变处理系统中的某些参数，最优控制变量的变化规律也将或多或少随着改变，但是，得到最优周期控制结果与其它控制策略相比，总是具有使出水水质刚好达到预定要求与满足所有约束条件的同时使其运行费用最省等特点.
　　5.本文还推荐在尚不具备实现最优控制条件的污水处理系统实施准最段控制，即根据求出的某特定处理系统的最优初始状态下的最优控制变量Qw和DO的变化规律，进行手动或半自动控制.
　　本研究第Ⅲ部分将研究常用的限制出水有机物浓度和同时限制平均与最高出水有机物浓度的两类最优周期控制问题.
参考文献
1　彭永臻，王宝贞，王淑莹.活性污泥法的多变量最优控制：Ⅰ.基础理论与DO浓度对运行费用的影响.环境科学学报，1998，18(1)：11―19
2　Benefield L D,Randall C W.Biological Process design for wastewater treatment.Prentice-Hall Inc,1980
3 Metcalf and Eddy.Inc.,Wastewater engineering:treatment,disposal,reuse,(2nd edition).McGraw Hall Book Company, 1979
4 王照林等编.现代控制理论基础.北京：国防工业出版社，1981
5　解学书编著.最优控制理论与应用.北京：清华大学出版社，1986
6　蔡宣三编著.最优化与最优控制.北京：清华大学出版社，1982
7　绪方胜彦著.卢伯英等译.现代控制理论.北京：科学出版社，1976
8　赵康怀编著.现代控制工程.北京：中国铁道出版社，1986
